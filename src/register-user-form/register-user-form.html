<link rel="import" href="../firebase-write-data/firebase-write-data.html">
<link rel="import" href="../firebase-read-data/firebase-read-data.html">
<link rel="import" href="/bower_components/polymerfire/firebase-app.html">
<link rel="import" href="./register-user-form-style.html">
<link rel="import" href="/bower_components/iron-localstorage/iron-localstorage.html">
<link rel="import" href="/bower_components/paper-card/paper-card.html">
<link rel="import" href="/bower_components/paper-input/paper-input.html">
<link rel="import" href="/bower_components/paper-input/paper-textarea.html">
<link rel="import" href="/bower_components/paper-button/paper-button.html">


<dom-module id="register-user-form">

  <template>
    
    <style include="register-user-form-styles"></style>
      <firebase-read-data path="/users" app-name="conjuntaApp" response="{{users}}"></firebase-read-data>
      <div class="content">
        
        <paper-card heading="Â¡Bienvenido {{user.name}}!">
          <div class="card-content">
          <form is="iron-form" method="get" action="/" id="basic">
              <paper-input name="user-name" label="User name" required></paper-input>
              <paper-input name="birth-date" label="dd/mm/yyyy" pattern="^(?:(?:0?[1-9]|1\d|2[0-8])(\/|-)(?:0?[1-9]|1[0-2]))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^(?:(?:31(\/|-)(?:0?[13578]|1[02]))|(?:(?:29|30)(\/|-)(?:0?[1,3-9]|1[0-2])))(\/|-)(?:[1-9]\d\d\d|\d[1-9]\d\d|\d\d[1-9]\d|\d\d\d[1-9])$|^(29(\/|-)0?2)(\/|-)(?:(?:0[48]00|[13579][26]00|[2468][048]00)|(?:\d\d)?(?:0[48]|[2468][048]|[13579][26]))$" required></paper-input>
              <paper-input name="city" label="City" required></paper-input>
              <paper-textarea name="Bio" label="Bio" char-counter maxlength="250" required></paper-textarea>
              <br>
              <div class="output"></div>
            </form>
          </div>
          <div class="card-actions">
            <paper-button class="send">Send</paper-button>
          </div>
        </paper-card>
      </div>
  </template>

<script>
(function() {
  Polymer({
    is: 'register-user-form',
    properties: {
      users: {
        type: Object,
        observer: "_mappingCard"
      },
      listData: {
        type: Array
      },
      cardAssaigned: {
        type: Object
      }
    },
     /*
      * this method mapped the object response from firebase
      * and transform this in array the object mapped
      */
      _mappingCard: function(){
        this.set('listData',[]);
        for(var object in this.users){
          var data = this.users[object];
              var card = {
                "imageSrc":data.photoURL,
                "mainTitle":data.displayName,
                "contents":[{"text":data.email}]
              };
              console.log(card.mainTitle)
              if(card.imageSrc){
                this.push("listData", card);
              }

        }
      }
  });
})();
</script>

</dom-module>
